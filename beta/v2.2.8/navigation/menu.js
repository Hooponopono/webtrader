define(["exports","jquery","../common/util"],function(a,b){"use strict";function c(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(a,"__esModule",{value:!0}),a.refreshMenu=a.extractChartableMarkets=a.extractFilteredMarkets=void 0;var d=c(b),e=a.extractFilteredMarkets=function(a,b){var c=a.trading_times.markets.map(function(a){var c={name:a.name,display_name:a.name};return c.submarkets=a.submarkets.map(function(a){var c={name:a.name,display_name:a.name},d=a.symbols;return b&&b.filter&&(d=d.filter(b.filter)),c.instruments=d.map(function(a){return{symbol:a.symbol,display_name:a.name,delay_amount:a.delay_amount||0,events:a.events,times:a.times,settlement:a.settlement,feed_license:a.feed_license||"realtime"}}),c}).filter(function(a){return a.instruments.length>0}),c});return c},f=a.extractChartableMarkets=function(a){return e(a,{filter:function(a){return"chartonly"!==a.feed_license}})||[]},g=a.refreshMenu=function(a,b,c){var e="<ul>"+b.map(function(a){return"<li><div>"+a.display_name+"</div><ul>"+a.submarkets.map(function(a){return"<li><div>"+a.display_name+"</div><ul>"+a.instruments.map(function(a){return"<li symbol='"+a.symbol+"' pip='"+a.pip+"'><div>"+a.display_name+"</div></li>"}).join("")+"</ul></li>"}).join("")+"</ul></li>"}).join("")+"</ul>",f=d["default"](e);a.find("> ul").menu("destroy").remove(),a.append(f),f.find("li[symbol]").on("click",function(b){var e=d["default"](b.target).text(),g=d["default"](b.target).closest("li"),h=g.attr("symbol"),i=g.attr("pip");f.detach(),a.append(f),c(h,e,i)}),f.menu({position:{collision:"fit"}})};a["default"]={extractChartableMarkets:f,extractFilteredMarkets:e,refreshMenu:g}});