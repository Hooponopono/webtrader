{"version":3,"sources":["../../../../src/assetindex/assetIndex.es6"],"names":["table_el","asset_win_el","header_el","dialog_buttons_el","init","li","click","windows","createBlankWindow","title","i18n","dialogClass","minWidth","minHeight","track","module_id","is_unique","data","dialog","require","initAssetWin","moveToTop","state","dropdown","display_markets","display_submarkets","is_volatility","market_submarkets","selected_market","table","asset_data","asset_data_extract","display_headers","display_asset_data","search_input","search","event","isTableRowSearchValue","asset","value","toLowerCase","indexOf","updateDisplayTable","filter","checkVolatility","market_name","market_names","volatility_indices","innerText","getMarketsSubmarkets","active_symbols","select_market_submarket","reduce","market_result","market","market_display_name","submarket_display_name","display_name","push","initTable","getActiveSymAndAssetsData","then","result","populateTable","catch","error","$","growl","message","console","active_symbols_data","Object","assign","asset_index_data","asset_index","parent","find","addClass","marketsDropdown","submarketsDropdown","updateTable","val","submarket_name","symbols","rows","map","props","symbol","forEach","asset_type","asset_list","asset_from","asset_to","assignAssetRows","fillFalseRows","assets","Array","isArray","asset_from_to","indexhead","header_length","length","i","row","makeSelectmenu","insertAfter","list","keys","inx","changed","submarket_list","update_list","width","selectmenu","processing_msg","attr","show","active_symbols_request","asset_index_request","Promise","all","liveapi","cached","send","results","hide","resolve","reject","$html","appendTo","rv","bind","events","on"],"mappings":"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","file":"assetIndex.js","sourcesContent":["ï»¿import $ from 'jquery';\nimport windows from '../windows/windows';\nimport liveapi from '../websockets/binary_websockets';\nimport rv from 'common/rivetsExtra';\nimport 'jquery-growl';\nimport 'css!./assetIndex.css';\n\nlet table_el = null;\nlet asset_win_el = null;\nlet header_el = null;\nlet dialog_buttons_el = null;\n\nexport const init = (li) => {\n    li.click(() => {\n        if (!asset_win_el) {\n            asset_win_el = windows.createBlankWindow($('<div/>'), {\n                title: 'Asset Index'.i18n(),\n                dialogClass: 'assetIndex',\n                minWidth: 800,\n                minHeight: 400,\n            });\n            asset_win_el.track({\n                module_id: 'assetIndex',\n                is_unique: true,\n                data: null\n            });\n            asset_win_el.dialog('open');\n            require(['text!assetindex/assetIndex.html'], initAssetWin);\n        } else\n            asset_win_el.moveToTop();\n    });\n}\n\nconst state = {\n    dropdown: {\n        display_markets: null,\n        display_submarkets: null,\n        is_volatility: false,\n        market_submarkets: null,\n        selected_market: null\n    },\n    table: {\n        asset_data: [],\n        asset_data_extract: [],\n        display_headers: [],\n        display_asset_data: [],\n        search_input: ''\n    },\n    search: function (event) {\n        function isTableRowSearchValue(asset) {\n            const value = state.table.search_input.toLowerCase();\n            return asset[0].toLowerCase().indexOf(value.toLowerCase()) !== -1;\n        }\n\n        return (function updateDisplayTable() {\n            state.table.display_asset_data = [];\n            state.table.display_asset_data = state.table.asset_data_extract.filter(isTableRowSearchValue);\n            state.dropdown.is_volatility = checkVolatility(state.dropdown.selected_market, state.dropdown.display_markets);\n        })();\n    }\n}\n\nconst checkVolatility = (market_name, market_names) => {\n    const volatility_indices = market_names[0][2] ? market_names[0][2].innerText : market_names[0][0].innerText;\n    const is_volatility = market_name.indexOf(volatility_indices) !== -1;\n\n    return is_volatility;\n}\n\nconst getMarketsSubmarkets = (active_symbols) => {\n    const select_market_submarket = active_symbols.reduce((market_result, market) => {\n        const { market_display_name, submarket_display_name, display_name } = market;\n\n        market_result[market_display_name] = market_result[market_display_name] || {};\n        market_result[market_display_name][submarket_display_name] = market_result[market_display_name][submarket_display_name] || [];\n        market_result[market_display_name][submarket_display_name].push(display_name);\n\n        return market_result;\n    }, {})\n\n    return select_market_submarket\n}\n\nconst initTable = () => {\n    getActiveSymAndAssetsData()\n        .then((result) => {\n            populateTable(result);\n        })\n        .catch((error) => {\n            $.growl.error({ message: error.message });\n            console.error(error);\n        });\n\n    function populateTable(result) {\n        const active_symbols_data = Object.assign(result[0].active_symbols);\n        const asset_index_data = [...result[1].asset_index];\n\n        state.dropdown.market_submarkets = getMarketsSubmarkets(active_symbols_data);\n        state.table.asset_data = asset_index_data;\n\n        header_el = asset_win_el.parent().find('.ui-dialog-title').addClass('with-content');\n        dialog_buttons_el = asset_win_el.parent().find('.ui-dialog-titlebar-buttonpane');\n\n        marketsDropdown(state.dropdown.market_submarkets);\n        submarketsDropdown(state.dropdown.market_submarkets);\n        updateTable(state.dropdown.display_markets.val(), state.dropdown.display_submarkets.val());\n\n        function updateTable(market_name, submarket_name) {\n            const symbols = [...state.dropdown.market_submarkets[market_name][submarket_name]];\n            state.dropdown.selected_market = market_name;\n            state.dropdown.is_volatility = checkVolatility(market_name, state.dropdown.display_markets);\n            let rows = state.table.asset_data\n                .filter((asset) => symbols.indexOf(asset[1]) > -1) // asset[1] is symbol\n                .map((asset) => {\n                    const props = [];\n                    const symbol = asset[1];\n                    const asset_data = asset[2];\n                    state.table.display_headers = [];\n                    props.push(symbol);\n                    asset_data.forEach(asset_list => {\n                        const asset_type = asset_list[1];\n                        const asset_from = asset_list[2];\n                        const asset_to = asset_list[3];\n                        state.table.display_headers.push(asset_type);\n                        props.push([asset_type, `${asset_from} - ${asset_to}`]);\n                    });\n\n                    return props;\n                });\n            rows = assignAssetRows(rows);\n            rows = fillFalseRows(rows);\n\n            state.table.display_asset_data = rows;\n            state.table.asset_data_extract = rows;\n\n            function assignAssetRows(rows) {\n                rows.forEach((assets) => {\n                    assets.forEach(asset => {\n                        if (Array.isArray(asset)) {\n                            const asset_type = asset[0];\n                            const asset_from_to = asset[1];\n                            const indexhead = state.table.display_headers.indexOf(asset_type) + 1;\n                            assets[indexhead] = asset_from_to;\n                        }\n                    });\n                });\n\n                return rows;\n            }\n\n            function fillFalseRows(rows) {\n                const header_length = state.table.display_headers.length;\n\n                for (let i = 0; i <= header_length; i++) {\n                    rows.forEach(row => {\n                        if (!row[i] || Array.isArray[row[i]]) {\n                            row[i] = '-';\n                        }\n                    });\n                }\n\n                return rows;\n            }\n        }\n\n        function marketsDropdown(market_submarkets) {\n            if (!state.dropdown.display_markets) {\n                state.dropdown.display_markets = windows\n                    .makeSelectmenu($('<select />').insertAfter(asset_win_el), {\n                        list: Object.keys(market_submarkets),\n                        inx: 0,\n                        changed: (val) => {\n                            const submarket_list = Object.keys(market_submarkets[val]);\n                            state.dropdown.display_submarkets.update_list(submarket_list);\n                            updateTable(state.dropdown.display_markets.val(), state.dropdown.display_submarkets.val());\n                        },\n                        width: '180px'\n                    });\n                state.dropdown.display_markets.selectmenu('widget').addClass('asset-index-selectmenu');\n            } else {\n                state.dropdown.display_markets.update_list(Object.keys(market_submarkets));\n            }\n        }\n\n        function submarketsDropdown(market_submarkets) {\n            if (!state.dropdown.display_submarkets) {\n                state.dropdown.display_submarkets = windows\n                    .makeSelectmenu($('<select />').insertAfter(asset_win_el), {\n                        list: Object.keys(market_submarkets[state.dropdown.display_markets.val()]),\n                        inx: 0,\n                        changed: (val) => {\n                            updateTable(state.dropdown.display_markets.val(), state.dropdown.display_submarkets.val());\n                        },\n                        width: '200px'\n                    });\n                state.dropdown.display_submarkets.selectmenu('widget').addClass('asset-index-selectmenu');\n            } else {\n                state.dropdown.display_submarkets.update_list(Object.keys(market_submarkets[state.dropdown.display_markets.val()]));\n            }\n        }\n    }\n\n    function getActiveSymAndAssetsData() {\n        const processing_msg = $(`#${table_el.attr('id')}_processing`).show();\n        const active_symbols_request = { active_symbols: 'brief' };\n        const asset_index_request = { asset_index: 1 };\n\n        return Promise.all(\n            [\n                liveapi.cached.send(active_symbols_request),\n                liveapi.cached.send(asset_index_request),\n            ])\n            .then((results) => {\n                processing_msg.hide();\n                return Promise.resolve(results);\n            })\n            .catch((error) => {\n                processing_msg.hide();\n                return Promise.reject(error);\n            });\n    };\n}\n\nconst initAssetWin = ($html) => {\n    $html = $($html).i18n();\n    table_el = $html.filter('table');\n    $html.appendTo(asset_win_el);\n    rv.bind($html[0], state);\n    initTable();\n    require(['websockets/binary_websockets'], (liveapi) => {\n      liveapi.events.on('login', initTable);\n      liveapi.events.on('logout', initTable);\n   });\n}\n\nexport default {\n    init\n}"]}